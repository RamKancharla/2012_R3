<?xml version = '1.0' encoding = 'UTF-8'?>
<?oracle-xsl-mapper <!-- SPECIFICATION OF MAP SOURCES AND TARGETS, DO NOT MODIFY. -->
  <mapSources>
    <source type="XSD">
      <schema location="EAI.MSG.TOM.CM.198_PublishContactEventRequest.xsd"/>
      <rootElement name="pubContactRequest" namespace="http://www.reuters.com/ns/2007/09/01/GCAP/TOM/ContactPublish"/>
    </source>
  </mapSources>
  <mapTargets>
    <target type="WSDL">
      <schema location="http://inkaban3ua-eai01:7777/orabpel/xmllib/WSDL_Cache/TOM.wsdl"/>
      <rootElement name="CreateInternalContactsRequest" namespace="http://schemas.hp.com/SM/7"/>
    </target>
  </mapTargets>
  <!-- GENERATED BY ORACLE XSL MAPPER 10.1.3.3.0(build 070615.0525) AT [THU DEC 02 15:03:34 GMT+05:30 2010]. -->
?>
<xsl:stylesheet version="1.0" xmlns:mime="http://schemas.xmlsoap.org/wsdl/mime/" xmlns:gcap-cmt="http://www.reuters.com/ns/2007/09/01/GCAP/CommonMessageTypes" xmlns:bpws="http://schemas.xmlsoap.org/ws/2003/03/business-process/" xmlns:gcap-cut="http://www.reuters.com/ns/2007/09/01/GCAP/CommonUserTypes" xmlns:xmime="http://www.w3.org/2005/05/xmlmime" xmlns:ehdr="http://www.oracle.com/XSL/Transform/java/oracle.tip.esb.server.headers.ESBHeaderFunctions" xmlns:http="http://schemas.xmlsoap.org/wsdl/http/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:hwf="http://xmlns.oracle.com/bpel/workflow/xpath" xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" xmlns:ns2="http://www.w3.org/2001/XMLSchemainstance" xmlns:cmn="http://schemas.hp.com/SM/7/Common" xmlns:gcap-NAT="http://www.reuters.com/ns/2007/09/01/GCAP/NillableAccountTypes" xmlns:xp20="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.Xpath20" xmlns:xref="http://www.oracle.com/XSL/Transform/java/oracle.tip.xref.xpath.XRefXPathFunctions" xmlns:local="http://www.reuters.com/ns/2007/09/01/GCAP/TOM/ContactPublish" xmlns:ns1="http://schemas.hp.com/SM/7" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:ora="http://schemas.oracle.com/xpath/extension" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ids="http://xmlns.oracle.com/bpel/services/IdentityService/xpath" xmlns:orcl="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.ExtFunc" xmlns:ns0="http://www.reuters.com/ns/2007/09/01/GCAP/SchemaAnnotations" xmlns:gcap-cat="http://www.reuters.com/ns/2007/09/01/GCAP/CommonAccountTypes" exclude-result-prefixes="xsl gcap-cmt gcap-cut xsd gcap-NAT local ns0 gcap-cat mime xmime http soap cmn ns1 xsi bpws ehdr hwf xp20 xref ora ids orcl" xmlns:dvm="http://www.oracle.com/XSL/Transform/java/oracle.tip.dvm.LookupValue">
  <xsl:template match="/">
    <ns1:CreateInternalContactsRequest>
      <ns1:model>
        <ns1:keys>
          <ns1:transaction.id>
            <xsl:value-of select='concat("TOMInt_",/local:pubContactRequest/local:eaiHeader/gcap-cmt:tracingId)'/>
          </ns1:transaction.id>
        </ns1:keys>
        <ns1:instance>
          <ns1:transaction.id>
            <xsl:value-of select='concat("TOMInt_",/local:pubContactRequest/local:eaiHeader/gcap-cmt:tracingId)'/>
          </ns1:transaction.id>
          <ns1:LastName>
            <xsl:value-of select="/local:pubContactRequest/local:contact/local:lastName"/>
          </ns1:LastName>
          <ns1:FirstName>
            <xsl:value-of select="/local:pubContactRequest/local:contact/local:firstName"/>
          </ns1:FirstName>
          <ns1:Phone>
            <xsl:value-of select="/local:pubContactRequest/local:contact/local:telNumber"/>
          </ns1:Phone>
          <ns1:Email>
            <xsl:value-of select="/local:pubContactRequest/local:contact/local:emailAddress"/>
          </ns1:Email>
          <ns1:ContactId>
            <xsl:value-of select="/local:pubContactRequest/local:contact/local:UUID"/>
          </ns1:ContactId>
          <ns1:ParentAccountId>
            <xsl:value-of select="/local:pubContactRequest/local:contact/local:parentAccountID"/>
          </ns1:ParentAccountId>
          <ns1:CRMAction>
            <xsl:value-of select='dvm:lookupValue(&quot;oramds:/apps/EAIMetaData/dvm/TOMCM_InvokerActionCodeMap.dvm&quot;,&quot;InputActionCode&quot;,/local:pubContactRequest/local:actionCode,&quot;TOMActionCode&quot;,&quot;ERROR&quot;)'/>
          </ns1:CRMAction>
          <ns1:reuters.intersection.data>
            <xsl:for-each select="/local:pubContactRequest/local:contact/local:employeePositionList/local:employeePosition">
              <!--<xsl:if test='"true" = dvm:lookupValue("oramds:/apps/EAIMetaData/dvm/TOMCM_InvokerEmployeePositionNameFilter.dvm","PositionName",substring-before(substring-after(local:name," ")," "),"SendToTOM","false")'>-->
              <xsl:for-each select="local:accountList/local:account">
                <ns1:reuters.intersection.data>
                  <ns1:reuters.account.id>
                    <xsl:value-of select="local:id"/>
                  </ns1:reuters.account.id>
                  <ns1:reuters.position.name>
                    <xsl:value-of select="../../local:name"/>
                  </ns1:reuters.position.name>
                <!--  <xsl:choose>
                    <xsl:when test='xp20:matches(local:isPrimaryPosition,"Y")'>
                      <ns1:PrimaryFlag>
                        <xsl:text disable-output-escaping="no">true</xsl:text>
                      </ns1:PrimaryFlag>
                    </xsl:when>
                    <xsl:otherwise>
                      <ns1:PrimaryFlag>
                        <xsl:text disable-output-escaping="no">false</xsl:text>
                      </ns1:PrimaryFlag>
                    </xsl:otherwise>
                  </xsl:choose> -->
                </ns1:reuters.intersection.data>
              </xsl:for-each>
            </xsl:for-each>
          </ns1:reuters.intersection.data>
        </ns1:instance>
      </ns1:model>
    </ns1:CreateInternalContactsRequest>
  </xsl:template>
</xsl:stylesheet>
